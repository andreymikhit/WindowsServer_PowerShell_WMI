# WindowsServer_PowerShell_WMI
GeekBrains

---
### Lesson 1 / HW
Урок 1. Установка и настройка Windows Server
Установить операционные системы в режимах Core и GUI (с графическим рабочим столом). Отчеты в виде скриншотов (выбор режима установки Core\GUI, разбиение диска, вход в установленную систему).
На сервер необходимо установить операционную систему. Под систему отводится 200 Gb дискового пространства, под данные 100 Tb. Нужно ли использовать RAID массивы, если да, то какие и в какой конфигурации.
Есть сервер, с процессором, имеющим 6 ядер, на котором будут работать 50 человек и одна виртуальная машина. Что необходимо приобрести для лицензионной работы?

### Lesson 2 / HW
Урок 2. Основные инструменты администрирования Windows
Создайте нового пользователя, с необходимостью смены пароля при первом входе в систему и добавьте его в группу Пользователи удаленного рабочего стола
Остановите и запустите службу SSTP (SstpSvc) из графической оболочки и из командной строки
Сожмите том, создайте раздел, потом верните в исходное состояние
Подключите второй диск, преобразуйте его в GPT
Добавьте третий диск, создайте из 2 и 3 диска зеркальный том
Найдите ИД оборудования (pci\ven, например, контроллер жесткого диска или видеокарта) и сайт в интернете, откуда можно скачать драйвера для этого устройства
В диспетчере задач отфильтруйте приложения которые больше всего потребляют ресурсов процессора и оперативную память
Отфильтруйте систеные события с кодом 6013 или 7036
Создайте задание, которое будет в 14.00 в рабочие дни запускать команду ping 8.8.8.8
Промониторьте через Системный монтор загрузку процессора и пришлите лог
Через Монитор ресурсов просмотрите в разделе Диск-Процессы с дисковой активностью-System какие используются файлы

### Lesson 3 / HW
Урок 3. Настройка Active Directory
Перед каждым заданием я рекомендую делать снимки (snapshots) виртуальных машин.
1. Добавьте через Windows Admin Center роль "Доменные службы Active Directory" и компонету "Telnet"
2. Убедитесь в том, что они появились в "Диспетчере серверов"
3. Сделайте сервер контроллером домена через "Диспетчер серверов".
4. Установите дополнительный контроллер домена на второй машине через "Диспетчере серверов".

### Lesson 4 / HW
Урок 4. Основные команды PowerShell
Перед выполением домашнего задания создайте резерные копии (снапшоты) виртуальных машин с домен контроллерами
Запустите утилиты repadmin /showrepl
Запустите утилиту dcdiag /test:dns , /test:topology
Узнайте SID пользователя под учетной записью которого вошли в систему
Создайте защищиенную от удаления ОП (OU)
Создайте в ней учетные записи нескольких пользователей, компьютеров, группу
Добавьте пользователей в группу
Удалите созданную OU
Создайте групповую политику (GPO) с блокировкой ссылки "Игры" и поключите к любой OU
Удалите соданную GPO
Добавьте в качестве сервера пересылки адрес 8.8.8.8
Сделайте простой и рекурсивный запосы к ДНС серверу
Использую утилиту NTDSUtil и оснастки AD передайте две роли на второй контроллер домена
Выключите второй контроллер домена, поизведите захват ролей первым контроллером домена, удалите данные о втором контоллере домена из AD

### Lesson 5 / HW
Урок 5. Написание сценариев с использованием функций и конвейеров
Перед выполением домашнего задания создайте резерные копии (снапшоты) виртуальных машин с домен контроллерами
Установите DHCP сервер, произведите настройку области
Установите квоты через свойства диска, через GPO, через Диспетчер ресурсов файлового сервера
Запустите дедупликацию на диске D во вторник и пятницу в 02.00
Создайте виртуальный диск объемом 5 Гб и подключите его по технологии iSCSI
Создайте папку с именем 123 на диске С и дайте доступ учетной записи Админинстратор с правами только чтение

### Lesson 6 / HW
Урок 6. Удалённое управление с PowerShell
Установите роль WSUS, используя встроенную базу данных WID Database.
Настройте на синхронизацию с Microsoft Update, для русского и английского языков, ОС Window 7, 10 Server 2016 и 2019, синхронизация в 02.00
Создайте и настройте групповую политику на установку обновлений в 05.00 и последующую перезагрузку.
Установите роль Hyper-V
Хранилище файлов и конфигураций создайте на диске C
Создайте виртуальную машину 2 поколения
Установите на Hyper-V Windows 10
Установите Doker
Определите, какие образы установлены
Скачайте образ с репозитприя NanoServer и ServerCore
На ServerCore установите роль DNS
Создайте контейнер с этой ролью

### Lesson 7 / HW
Урок 7. Автоматизация Active Directory
Узнайте IP и МАС адреса компьютера используя конвеер Powershell
Установите офлайн модуль VMware.PowerCLI
С помощью Powershell отфильтруйте все запущенные процессы
Запустите, потом остановите процесс notepad (блокнот)
Отфильтруйте все события с кодом 7036 за последний месяц журнала Система
Создайте задание в планировщике
Посмотрите счетчики процессора при работе в пользовательском режиме
Добавьте роль ADDS, установите Контроллер домена
На компьютере работающем в режиме Core поднимите резевный контроллер
Создайте пользователя, группу, OU. Добавьте пользователя в группу.
Установите роль DHCP сервера, создайте область, настройте её (Диапазон адресов, адреса DNS, gate). Посмотрите настройки.
Включите созданную область
Экспортируйте настройки DHCP сервера

### Lesson 8 / HW
Урок 8. Windows Management Instrumentation (WMI)
Посмотрите информацию о физических дисках
Посмотите список всех логических разделов в Windows
Создайте раздел на диске объемом 1 Гб
Удалите ранее созданный раздел на диске
Включите мягкую квоту на диске С
Измените порог квоты для пользователя Администратор
Установите модуль Дедуплекации
Установите минимум для дедуплекации для файлов в 1GB
Настройте расписание таким образом, что бы процесс GarbageCollection запускался в пятницу в 22:00
Удалите созданное расписание
Используя wmi посмотрите запущенные процессы в системе
Запустите процесс cmd и с помощью wmi остановите его
Создайте GPO, WMI фильтр которой будет применяться к Windows 10

### Lesson 9 / HW
Урок 9. Аудит безопасности Windows
Включите все доступные профили брандмауэра Защитника Windows
Создайте исходящее правило для Internet Explorer
Создайте входящее правило для Internet Explorer
Экспотрируйте настройки брандмауэра Защитника Windows
Через локальные политики безопасности запретите запуск Internet Explorer
Включите установку обновлений для Windows и других продуктов Microsoft
Включите Аудит событий входа успех\отказ
Установите компонент «Система архивации данных Windows Server»
Создайте задачу ежедневного резервного копирования системного диска в 23.00
Удалите файлы с рабочего стола, затем восстановите их из резервной копии
Восстановите состояние сервера используя загрузочный диск и ранее созданную резервную копию
Испльзую утилиту WBadmin создайте резервную копию системы
Посмотрите, какое количество резервных копий "видит" система
Удалите самую старую резервную копию.
